Search.setIndex({"alltitles":{"API Reference":[[0,null]],"Attention Calc":[[3,"attention-calc"]],"Compute Pad Size":[[3,"compute-pad-size"]],"Contents":[[1,null]],"Dispatch Function":[[3,"dispatch-function"]],"Dispatch for multi masks":[[3,"dispatch-for-multi-masks"]],"Dispatch for varlen masks":[[3,"dispatch-for-varlen-masks"]],"Flexible Flash Attention":[[3,"flexible-flash-attention"]],"How to use MagiAttention":[[0,null],[3,"how-to-use-magiattention"]],"Installation":[[2,null]],"MagiAttention Api":[[3,null]],"MagiAttention documentation":[[1,null]],"Step1: Activate an NGC pytorch docker container":[[2,"step1-activate-an-ngc-pytorch-docker-container"]],"Step2: Install required packages":[[2,"step2-install-required-packages"]],"Step3: Install MagiAttention from source":[[2,"step3-install-magiattention-from-source"]],"Undispatch":[[3,"undispatch"]],"Utility functions needed":[[3,"utility-functions-needed"]]},"docnames":["api","index","install","magi_api"],"envversion":{"sphinx":65,"sphinx.domains.c":3,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":9,"sphinx.domains.index":1,"sphinx.domains.javascript":3,"sphinx.domains.math":2,"sphinx.domains.python":4,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2},"filenames":["api.md","index.md","install.md","magi_api.md"],"indexentries":{"attnmasktype (class in magi_attention.api)":[[3,"magi_attention.api.AttnMaskType",false]],"bicausal (magi_attention.api.attnmasktype attribute)":[[3,"magi_attention.api.AttnMaskType.BICAUSAL",false]],"calc_attn() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.calc_attn",false]],"causal (magi_attention.api.attnmasktype attribute)":[[3,"magi_attention.api.AttnMaskType.CAUSAL",false]],"compute_pad_size() (in module magi_attention.api.functools)":[[3,"magi_attention.api.functools.compute_pad_size",false]],"deterministic (magi_attention.api.distattnconfig attribute)":[[3,"magi_attention.api.DistAttnConfig.deterministic",false]],"dispatch_config (magi_attention.api.distattnconfig attribute)":[[3,"magi_attention.api.DistAttnConfig.dispatch_config",false]],"distattnconfig (class in magi_attention.api)":[[3,"magi_attention.api.DistAttnConfig",false]],"flex_flash_attn_func() (in module magi_attention.functional.flex_flash_attn)":[[3,"magi_attention.functional.flex_flash_attn.flex_flash_attn_func",false]],"full (magi_attention.api.attnmasktype attribute)":[[3,"magi_attention.api.AttnMaskType.FULL",false]],"high_bandwith_domain_size (magi_attention.api.distattnconfig attribute)":[[3,"magi_attention.api.DistAttnConfig.high_bandwith_domain_size",false]],"init_hierarchical_mesh() (in module magi_attention.api.functools)":[[3,"magi_attention.api.functools.init_hierarchical_mesh",false]],"invcausal (magi_attention.api.attnmasktype attribute)":[[3,"magi_attention.api.AttnMaskType.INVCAUSAL",false]],"magi_attention.api":[[3,"module-magi_attention.api",false]],"magi_attn_flex_dispatch() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.magi_attn_flex_dispatch",false]],"magi_attn_flex_key() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.magi_attn_flex_key",false]],"magi_attn_varlen_dispatch() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.magi_attn_varlen_dispatch",false]],"magi_attn_varlen_key() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.magi_attn_varlen_key",false]],"module":[[3,"module-magi_attention.api",false]],"overlap_config (magi_attention.api.distattnconfig attribute)":[[3,"magi_attention.api.DistAttnConfig.overlap_config",false]],"undispatch() (in module magi_attention.api.magi_attn_interface)":[[3,"magi_attention.api.magi_attn_interface.undispatch",false]]},"objects":{"magi_attention":[[3,0,0,"-","api"]],"magi_attention.api":[[3,1,1,"","AttnMaskType"],[3,1,1,"","DistAttnConfig"]],"magi_attention.api.AttnMaskType":[[3,2,1,"","BICAUSAL"],[3,2,1,"","CAUSAL"],[3,2,1,"","FULL"],[3,2,1,"","INVCAUSAL"]],"magi_attention.api.DistAttnConfig":[[3,2,1,"","deterministic"],[3,2,1,"","dispatch_config"],[3,2,1,"","high_bandwith_domain_size"],[3,2,1,"","overlap_config"]],"magi_attention.api.functools":[[3,3,1,"","compute_pad_size"],[3,3,1,"","init_hierarchical_mesh"]],"magi_attention.api.magi_attn_interface":[[3,3,1,"","calc_attn"],[3,3,1,"","magi_attn_flex_dispatch"],[3,3,1,"","magi_attn_flex_key"],[3,3,1,"","magi_attn_varlen_dispatch"],[3,3,1,"","magi_attn_varlen_key"],[3,3,1,"","undispatch"]],"magi_attention.functional.flex_flash_attn":[[3,3,1,"","flex_flash_attn_func"]]},"objnames":{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","attribute","Python attribute"],"3":["py","function","Python function"]},"objtypes":{"0":"py:module","1":"py:class","2":"py:attribute","3":"py:function"},"terms":{"":3,"0":3,"02":2,"1":[1,2,3],"10":3,"1024":3,"128":3,"15":3,"192":3,"1d":3,"2":[1,3],"20":3,"2048":3,"25":[2,3],"256":3,"2d":3,"3":[1,3],"30":3,"384":3,"4":[1,3],"4096":3,"42":3,"48":3,"5":[1,3],"512":3,"64":3,"640":3,"67108864":2,"7":3,"768":3,"8":3,"960":3,"AND":3,"By":3,"For":3,"If":3,"In":3,"The":[1,3],"To":[1,3],"With":1,"_":3,"about":3,"abov":3,"accord":3,"achiev":1,"across":[1,3],"activ":0,"adapt":1,"addit":3,"address":1,"after":3,"aim":1,"alg":3,"align":3,"all":[1,2,3],"along":3,"also":3,"amount":3,"an":[0,1,3],"ani":3,"api":1,"appli":3,"ar":[1,3],"arg":3,"argument":3,"assert":3,"assign":3,"atom":3,"attent":[0,1],"attn":3,"attn_mask_typ":3,"attn_type_map":3,"attnmasktyp":3,"attnoverlapmod":3,"attnrang":3,"b":3,"back":3,"backend":3,"backward":1,"balanc":[1,3],"base":[1,3],"bash":2,"basic":3,"batch":3,"batch_siz":3,"becaus":3,"below":3,"better":3,"bfloat16":3,"bi_caus":3,"bicaus":3,"bidirect":3,"bin":2,"block":1,"blog":3,"bool":3,"both":3,"bother":3,"bottom":3,"broad":1,"build":2,"cacul":3,"calc":0,"calc_attn":3,"calc_cost_factor":3,"calcul":3,"call":3,"can":3,"care":3,"cast":1,"causal":[1,3],"cd":2,"challeng":1,"chun_siz":3,"chunk":3,"chunk_siz":3,"class":3,"classifi":1,"clone":2,"column":3,"com":2,"combin":[1,3],"comm":3,"comm_cost_factor":3,"command":2,"commun":[1,3],"complex":1,"comput":[0,1],"compute_pad_s":3,"config":3,"configur":3,"consist":3,"contain":[0,3],"container_mnt_root":2,"container_nam":2,"context":[1,3],"control":3,"corr":3,"correspond":3,"cp":[1,3],"cp_group":3,"cp_mesh":3,"cp_size":3,"creat":3,"cross":3,"cu_seqlen":3,"cu_seqlen_k":3,"cu_seqlen_q":3,"cu_seqlens_k":3,"cu_seqlens_q":3,"cuda":3,"cuda_device_max_connect":3,"cumul":3,"current_devic":3,"d":2,"data":[1,3],"dataclass":3,"datetim":3,"decod":3,"defin":3,"degre":3,"describ":1,"descript":3,"design":3,"determinist":3,"devic":3,"devicemesh":3,"differ":3,"dim":3,"dim0":3,"directli":3,"disabl":3,"disable_fwd_atomic_reduct":3,"dispatch":[0,1],"dispatch_config":3,"dispatchconfig":3,"dist":3,"dist_attn_config":3,"dist_attn_runtime_kei":3,"distattbruntimekei":3,"distattnconfig":3,"distattnruntimedict":3,"distattnruntimekei":3,"distattnruntimemgr":3,"distribut":3,"divers":[1,3],"divid":3,"divis":3,"do":3,"docker":0,"doe":3,"doesn":3,"don":3,"dtype":3,"due":3,"dure":[1,3],"dynamic_max_degre":3,"e":3,"each":3,"easi":3,"easili":3,"effici":1,"either":3,"element":3,"elimin":1,"els":3,"embed_dim":3,"empti":3,"enabl":3,"encod":3,"ensur":[1,3],"enum":3,"environ":3,"even":3,"evenli":3,"exampl":3,"exclus":3,"exec":2,"exist":3,"exp":3,"explain":3,"explan":3,"export":3,"extern":3,"extrem":1,"fals":3,"faster":3,"featur":1,"ffa":1,"final":3,"first":3,"flash":[0,1],"flash_attn_varlen":3,"flashattent":3,"flex":3,"flex_flash_attn":3,"flex_flash_attn_func":3,"flexibl":[0,1],"flexible_flash_attent":3,"float":3,"float32":3,"follow":3,"forward":[1,3],"from":[0,3],"from_rang":3,"full":3,"full_attention_to_varlen_attent":3,"function":0,"functool":3,"further":3,"g":3,"gather":3,"gener":[1,3],"get":3,"git":2,"github":[2,3],"global":3,"gpt":3,"gpu":[2,3],"granular":3,"group":[1,3],"h":3,"ha":3,"have":3,"hd":3,"head":3,"head_dim":3,"help":3,"here":[2,3],"heterogen":1,"hidden_s":3,"hierarch":3,"hierarchical_comm":3,"high_bandwith_domain_s":3,"highli":1,"hold":3,"host":2,"host_mnt_root":2,"http":[2,3],"i":[1,3],"imag":2,"implement":3,"import":3,"includ":3,"init":[2,3],"init_hierarchical_mesh":3,"init_process_group":3,"initi":3,"inner":3,"input":3,"inspir":3,"instal":[0,1],"instead":3,"instruct":3,"int":3,"int32":3,"inter":3,"interfac":3,"intersect":3,"introduc":1,"inv_caus":3,"invcaus":3,"invers":3,"invok":3,"involv":1,"io":[2,3],"ipc":2,"irregular":3,"is_k_permut":3,"is_q_permut":3,"is_same_sourc":3,"isol":2,"its":3,"just":3,"k":3,"k_proj":3,"k_project":3,"k_rang":3,"kei":3,"kernel":[1,3],"kv_head":3,"larg":1,"left":3,"length":[1,3],"level":1,"like":[1,3],"limit":3,"linear":[1,3],"list":3,"load":[1,3],"local":3,"local_k":3,"local_out":3,"local_q":3,"local_rank":3,"local_v":3,"local_x":3,"log":3,"logic":3,"long":[1,3],"lse":3,"machin":3,"magi":1,"magi_attent":3,"magi_attention_hierarchical_comm":3,"magi_attn_flex_dispatch":3,"magi_attn_flex_kei":3,"magi_attn_interfac":3,"magi_attn_kernel":3,"magi_attn_runtime_kei":3,"magi_attn_varlen_dispatch":3,"magi_attn_varlen_kei":3,"mai":3,"mainli":3,"major":1,"make":3,"mani":3,"map":3,"mask":1,"max_num_chunk":3,"max_seqlen_k":3,"max_seqlen_q":3,"maximum":3,"memlock":2,"memori":1,"mention":3,"mesh":3,"meta":3,"million":1,"min_chunk_s":3,"minheapdispatchalg":3,"minut":3,"mix":3,"modal":3,"mode":3,"model":1,"modul":3,"more":3,"most":3,"multipl":3,"multiprocessor":3,"must":3,"mutual":3,"name":[2,3],"nccl":3,"necessari":3,"need":0,"network":2,"new_group":3,"ngc":0,"nh":3,"nn":3,"non":3,"none":3,"note":[2,3],"now":3,"num_head":3,"num_rang":3,"num_tokens_k":3,"num_tokens_kv":3,"num_tokens_q":3,"num_tokens_v":3,"number":3,"numer":3,"nvcr":2,"nvidia":2,"o":3,"object":3,"obtain":3,"offer":3,"one":3,"onli":3,"optim":1,"option":3,"org":[2,3],"origin":3,"other":3,"our":3,"out":3,"output":3,"overal":3,"overhead":1,"overlap":[1,3],"overlap_config":3,"overlapalgtyp":3,"overlapconfig":3,"overview":1,"pack":1,"packag":0,"pad":[0,1],"pad_siz":3,"padded_x":3,"parallel":[1,3],"param":3,"paramet":3,"part":3,"particularli":1,"partit":1,"pass":3,"pattern":1,"perform":3,"permut":3,"pip":2,"pnp":1,"prepar":3,"present":1,"primit":1,"privileg":2,"process":3,"processgroup":3,"prohibit":1,"project":3,"propos":1,"provid":3,"py3":2,"pytorch":0,"q":3,"q_head":3,"q_proj":3,"q_project":3,"q_rang":3,"qkv":3,"queri":3,"quickli":3,"r":2,"rais":3,"randn":3,"random_cost":3,"random_se":3,"rang":[1,3],"rank":3,"re":3,"reach":1,"receiv":3,"recommend":3,"recurs":2,"reduc":1,"reduct":3,"redund":1,"ref":3,"refer":1,"releas":[1,2],"repres":3,"represent":3,"requir":[0,3],"requires_grad":3,"reserv":3,"respect":1,"result":[1,3],"return":3,"return_dtyp":3,"right":3,"row":3,"run":2,"runtim":3,"runtime_kei":3,"same":3,"sandai":[2,3],"scalabl":1,"scale":[1,3],"scenario":1,"second":3,"see":3,"self":3,"semant":3,"seq_dim":3,"seq_len":3,"seqlen":3,"seqlen_k":3,"seqlen_q":3,"seqln":3,"sequenc":3,"set":3,"set_devic":3,"shape":3,"shard":1,"share":3,"should":3,"shown":3,"similar":3,"size":[0,1],"slide":3,"sm":3,"sm_margin":3,"softcap":3,"softmax":3,"softmax_scal":3,"solver":1,"some":3,"sourc":[0,3],"specifi":3,"squash":3,"squash_batch_dim":3,"stabil":3,"stack":2,"start":3,"static":3,"statu":1,"step1":0,"step2":0,"step3":0,"str":3,"stream":3,"string":3,"sub":3,"submodul":2,"subsequ":3,"suitabl":1,"sum":3,"support":[1,3],"t":3,"t5":3,"task":1,"techniqu":1,"tensor":3,"test":1,"thei":3,"them":3,"thi":[1,3],"through":3,"timedelta":3,"timelin":1,"timeout":3,"togeth":1,"token":[1,3],"top":3,"torch":3,"total":3,"total_k":3,"total_out":3,"total_q":3,"total_seq":3,"total_seqlen":3,"total_seqlen_k":3,"total_seqlen_q":3,"total_v":3,"totoal_seqlen_q":3,"train":1,"transform":3,"true":3,"tupl":3,"two":[1,3],"txt":2,"type":[1,3],"typic":3,"ulimit":2,"ultra":1,"under":1,"undispatch":0,"uniform":3,"uniformoverlapalg":3,"unit":3,"unpad":3,"unpermut":3,"up":1,"updat":2,"usag":3,"user":3,"util":0,"v":[2,3],"v_proj":3,"v_project":3,"valu":3,"valueerror":3,"varieti":1,"ve":3,"version":2,"video":1,"view":3,"visual":3,"wai":3,"want":3,"we":[1,3],"when":3,"whether":3,"which":[1,3],"while":[1,3],"wide":1,"window":3,"wise":3,"world":3,"world_siz":3,"world_size_inter_nod":3,"world_size_intra_nod":3,"x":3,"x_with_batch":3,"you":3},"titles":["API Reference","MagiAttention documentation","Installation","MagiAttention Api"],"titleterms":{"activ":2,"an":2,"api":[0,3],"attent":3,"calc":3,"comput":3,"contain":2,"content":1,"dispatch":3,"docker":2,"document":1,"flash":3,"flexibl":3,"from":2,"function":3,"how":[0,3],"instal":2,"magiattent":[0,1,2,3],"mask":3,"multi":3,"need":3,"ngc":2,"packag":2,"pad":3,"pytorch":2,"refer":0,"requir":2,"size":3,"sourc":2,"step1":2,"step2":2,"step3":2,"undispatch":3,"us":[0,3],"util":3,"varlen":3}})