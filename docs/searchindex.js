Search.setIndex({"alltitles":{"API Reference":[[0,null]],"Attention Calc":[[3,"attention-calc"]],"Compute Pad Size":[[3,"compute-pad-size"]],"Contents":[[1,null]],"Dispatch Function":[[3,"dispatch-function"]],"Dispatch for multi masks":[[3,"dispatch-for-multi-masks"]],"Dispatch for varlen masks":[[3,"dispatch-for-varlen-masks"]],"Flexible Flash Attention":[[3,"flexible-flash-attention"]],"How to use MagiAttention":[[0,null],[3,"how-to-use-magiattention"]],"Installation":[[2,null]],"MagiAttention Api":[[3,null]],"MagiAttention documentation":[[1,null]],"Step1: Activate an NGC pytorch docker container":[[2,"step1-activate-an-ngc-pytorch-docker-container"]],"Step2: Install required packages":[[2,"step2-install-required-packages"]],"Step3: Install MagiAttention from source":[[2,"step3-install-magiattention-from-source"]],"Undispatch":[[3,"undispatch"]],"Utility functions needed":[[3,"utility-functions-needed"]]},"docnames":["api","index","install","magi_api"],"envversion":{"sphinx":65,"sphinx.domains.c":3,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":9,"sphinx.domains.index":1,"sphinx.domains.javascript":3,"sphinx.domains.math":2,"sphinx.domains.python":4,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2},"filenames":["api.md","index.md","install.md","magi_api.md"],"indexentries":{"magi_attention.api":[[3,"module-magi_attention.api",false]],"module":[[3,"module-magi_attention.api",false]]},"objects":{"magi_attention":[[3,0,0,"-","api"]]},"objnames":{"0":["py","module","Python module"]},"objtypes":{"0":"py:module"},"terms":{"":3,"0":3,"02":2,"1":[1,2,3],"1024":3,"128":3,"2":[1,3],"25":[2,3],"256":3,"3":1,"30":3,"384":3,"4":1,"42":3,"48":3,"5":[1,3],"512":3,"64":3,"640":3,"67108864":2,"7":3,"768":3,"8":3,"960":3,"By":3,"For":3,"If":3,"In":3,"The":[1,3],"To":[1,3],"With":1,"_":3,"abov":3,"accord":3,"achiev":1,"across":[1,3],"activ":0,"adapt":1,"address":1,"after":3,"aim":1,"alg":3,"all":[1,2,3],"also":3,"an":[0,1,3],"api":1,"ar":[1,3],"arg":3,"assert":3,"attent":[0,1],"attn_mask_typ":3,"attnmasktyp":3,"attnoverlapmod":3,"attnrang":3,"b":3,"back":3,"backend":3,"backward":1,"balanc":1,"base":1,"bash":2,"basic":3,"batch":3,"batch_siz":3,"below":3,"better":3,"bfloat16":3,"bin":2,"block":1,"broad":1,"build":2,"calc":0,"calc_attn":3,"calcul":3,"call":3,"can":3,"cast":1,"causal":[1,3],"cd":2,"challeng":1,"chunk":3,"chunk_siz":3,"classifi":1,"clone":2,"com":2,"combin":1,"command":2,"commun":[1,3],"complex":1,"comput":[0,1],"compute_pad_s":3,"configur":3,"consist":3,"contain":0,"container_mnt_root":2,"container_nam":2,"context":1,"correspond":3,"cp":1,"cp_group":3,"cp_mesh":3,"cp_size":3,"creat":3,"cu_seqlen":3,"cu_seqlens_k":3,"cu_seqlens_q":3,"cuda":3,"cuda_device_max_connect":3,"current_devic":3,"d":2,"data":[1,3],"datetim":3,"defin":3,"degre":3,"describ":1,"descript":3,"design":3,"devic":3,"devicemesh":3,"dim":3,"dispatch":[0,1],"dispatch_config":3,"dispatchconfig":3,"dist":3,"dist_attn_config":3,"distattnconfig":3,"distribut":3,"divers":[1,3],"divid":3,"divis":3,"do":3,"docker":0,"dtype":3,"dure":[1,3],"each":3,"easi":3,"easili":3,"effici":1,"either":3,"elimin":1,"embed_dim":3,"enabl":3,"ensur":[1,3],"enum":3,"environ":3,"evenli":3,"exampl":3,"exec":2,"export":3,"extrem":1,"fals":3,"featur":1,"ffa":1,"first":3,"flash":[0,1],"flashattent":3,"flexibl":[0,1],"flexible_flash_attent":3,"follow":3,"forward":1,"from":[0,3],"from_rang":3,"full":3,"full_attention_to_varlen_attent":3,"function":0,"gather":3,"gener":1,"get":3,"git":2,"github":2,"global":3,"gpu":[2,3],"group":1,"h":3,"hd":3,"head_dim":3,"help":3,"here":[2,3],"heterogen":1,"hierarch":3,"hierarchical_comm":3,"high_bandwith_domain_s":3,"highli":1,"host":2,"host_mnt_root":2,"http":2,"i":[1,3],"imag":2,"implement":3,"import":3,"includ":3,"init":[2,3],"init_hierarchical_mesh":3,"init_process_group":3,"initi":3,"input":3,"inspir":3,"instal":[0,1],"instead":3,"instruct":3,"int":3,"interfac":3,"introduc":1,"invok":3,"involv":1,"io":2,"ipc":2,"irregular":3,"is_k_permut":3,"is_q_permut":3,"is_same_sourc":3,"isol":2,"its":3,"just":3,"k":3,"k_proj":3,"k_rang":3,"kei":3,"kernel":[1,3],"kv_head":3,"larg":1,"length":[1,3],"level":1,"like":1,"limit":3,"linear":[1,3],"list":3,"load":1,"local":3,"local_k":3,"local_out":3,"local_q":3,"local_rank":3,"local_v":3,"local_x":3,"logic":3,"long":1,"lse":3,"magi":1,"magi_attent":3,"magi_attention_hierarchical_comm":3,"magi_attn_flex_dispatch":3,"magi_attn_flex_kei":3,"magi_attn_runtime_kei":3,"magi_attn_varlen_dispatch":3,"magi_attn_varlen_kei":3,"mainli":3,"major":1,"make":3,"mask":1,"max_num_chunk":3,"memlock":2,"memori":1,"mention":3,"million":1,"min_chunk_s":3,"minheapdispatchalg":3,"minut":3,"mode":3,"model":1,"more":3,"multipl":3,"name":[2,3],"nccl":3,"necessari":3,"need":0,"network":2,"new_group":3,"ngc":0,"nh":3,"nn":3,"none":3,"note":2,"number":3,"nvcr":2,"nvidia":2,"o":3,"obtain":3,"offer":3,"optim":1,"org":2,"origin":3,"other":3,"out":3,"overhead":1,"overlap":1,"overlap_config":3,"overlapconfig":3,"overview":1,"pack":1,"packag":0,"pad":[0,1],"pad_siz":3,"parallel":1,"param":3,"paramet":3,"part":3,"particularli":1,"partit":1,"pass":3,"pattern":1,"perform":3,"pip":2,"pnp":1,"prepar":3,"present":1,"primit":1,"privileg":2,"process":3,"prohibit":1,"project":3,"propos":1,"provid":3,"py3":2,"pytorch":0,"q":3,"q_head":3,"q_proj":3,"q_rang":3,"qkv":3,"queri":3,"quickli":3,"r":2,"randn":3,"random_cost":3,"random_se":3,"rang":[1,3],"rank":3,"re":3,"reach":1,"receiv":3,"recommend":3,"recurs":2,"reduc":1,"redund":1,"refer":1,"releas":[1,2],"represent":3,"requir":[0,3],"requires_grad":3,"respect":1,"result":[1,3],"return":3,"run":2,"runtim":3,"runtime_kei":3,"same":3,"sandai":2,"scalabl":1,"scale":1,"scenario":1,"second":3,"seqlen":3,"set":3,"set_devic":3,"shape":3,"shard":1,"should":3,"shown":3,"similar":3,"size":[0,1],"slide":3,"solver":1,"sourc":0,"squash":3,"squash_batch_dim":3,"stack":2,"start":3,"static":3,"statu":1,"step1":0,"step2":0,"step3":0,"str":3,"string":3,"submodul":2,"subsequ":3,"suitabl":1,"support":[1,3],"task":1,"techniqu":1,"tensor":3,"test":1,"them":3,"thi":[1,3],"through":3,"timedelta":3,"timelin":1,"timeout":3,"togeth":1,"token":1,"torch":3,"total":3,"total_out":3,"total_seq":3,"total_seqlen":3,"total_seqlen_k":3,"total_seqlen_q":3,"totoal_seqlen_q":3,"train":1,"true":3,"two":[1,3],"txt":2,"type":[1,3],"typic":3,"ulimit":2,"ultra":1,"under":1,"undispatch":0,"uniformoverlapalg":3,"unpad":3,"up":1,"updat":2,"usag":3,"util":0,"v":[2,3],"v_proj":3,"valu":3,"varieti":1,"ve":3,"version":2,"video":1,"view":3,"want":3,"we":[1,3],"which":[1,3],"while":1,"wide":1,"window":3,"world_siz":3,"x":3,"x_with_batch":3,"you":3},"titles":["API Reference","MagiAttention documentation","Installation","MagiAttention Api"],"titleterms":{"activ":2,"an":2,"api":[0,3],"attent":3,"calc":3,"comput":3,"contain":2,"content":1,"dispatch":3,"docker":2,"document":1,"flash":3,"flexibl":3,"from":2,"function":3,"how":[0,3],"instal":2,"magiattent":[0,1,2,3],"mask":3,"multi":3,"need":3,"ngc":2,"packag":2,"pad":3,"pytorch":2,"refer":0,"requir":2,"size":3,"sourc":2,"step1":2,"step2":2,"step3":2,"undispatch":3,"us":[0,3],"util":3,"varlen":3}})